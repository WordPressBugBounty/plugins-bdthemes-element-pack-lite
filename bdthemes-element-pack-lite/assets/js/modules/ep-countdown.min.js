(()=>{"use strict";const e=(e,t,o)=>{let n="";if(o){const e=new Date;e.setTime(e.getTime()+60*o*60*1e3),n=`; expires=${e.toUTCString()}`}document.cookie=`${e}=${t??""}${n}; path=/`},t=e=>{const t=document.cookie.split(";").find((t=>t.trimStart().startsWith(e+"=")));return t?t.trimStart().slice(e.length+1):null},o=e=>{const t=e-Date.now();return{total:t,seconds:Math.floor(t/1e3%60)}},n=n=>{const d=(n instanceof jQuery?n[0]:n).querySelector(".bdt-countdown-wrapper");if(!d)return;const r=d.dataset.settings;if(!r)return;let i;try{i="string"==typeof r?JSON.parse(r):r}catch(e){return void console.error("Failed to parse countdown settings:",e)}const{endTime:c,loopHours:s,isLogged:a}=i,l=document.body.classList.contains("elementor-editor-active");if(!s){const e=document.querySelector(`${i.id}-timer`),t=bdtUIkit.countdown(e,{date:i.finalTime}),n=setInterval((()=>{const{seconds:e}=o(t.date);e<0&&(clearInterval(n),l||(document.querySelector(`${i.id}-msg`)?.style.setProperty("display","none"),("none"!==i.endActionType||i.triggerId)&&(async(e,t)=>{try{const o=new URLSearchParams({action:"element_pack_countdown_end",endTime:t,couponTrickyId:e.couponTrickyId}),n=await fetch(e.adminAjaxUrl,{method:"POST",body:o});if("ended"!==await n.text())return;"message"===e.endActionType&&(document.querySelector(e.msgId)?.style.setProperty("display","block"),document.querySelector(`${e.id}-timer`)?.style.setProperty("display","none")),"url"===e.endActionType&&e.redirectUrl?.includes("http")&&setTimeout((()=>{window.location.href=e.redirectUrl}),e.redirectDelay),e.triggerId&&setTimeout((()=>{document.getElementById(e.triggerId)?.click()}),1500)}catch(e){console.error("Countdown end action failed:",e)}})(i,c)))}),1e3)}if(s){const n=(u=6,m=14,Math.floor(Math.random()*(m-u+1)+u)),d=60*s*60*1e3-60*n*1e3,r=new Date(Date.now()+d).toISOString(),c=t("bdtCountdownLoopTime"),l=null===c||"undefined"===c;l&&!1===a&&e("bdtCountdownLoopTime",r,s);const y=!1!==a?r:t("bdtCountdownLoopTime"),w=document.querySelector(`${i.id}-timer`);w?.setAttribute("data-bdt-countdown",`date: ${y}`);const p=bdtUIkit.countdown(w,{date:y}).date;setInterval((()=>{const{seconds:t}=o(p);t>0&&l&&!1===a&&(e("bdtCountdownLoopTime",r,s),bdtUIkit.countdown(w,{date:y}))}),1e3)}var u,m};window.addEventListener("elementor/frontend/init",(()=>{window.elementorFrontend?.hooks&&(elementorFrontend.hooks.addAction("frontend/element_ready/bdt-countdown.default",n),elementorFrontend.hooks.addAction("frontend/element_ready/bdt-countdown.bdt-tiny-countdown",n))}))})();